import{d as W,X as Y,o as u,z as Z,A as d,C as l,a as p,H as y,J as S,_ as k,$ as I,D as V,E as ee,G as t,a0 as ae,M as H,O as te,P as oe,I as se}from"./index-47e2b40a.js";/* empty css              */import{P as ne}from"./index-ec807d4b.js";import{E as le}from"./index-03d0c034.js";import{L as ie}from"./index-5035f66e.js";import{b as ce,T as re}from"./index-c7415b77.js";import{I as ue}from"./index-84671b39.js";import"./index-dd22c253.js";import{F as de}from"./index-9c118d08.js";import{r as ve}from"./index-79c4f64d.js";import{u as pe}from"./useApp-90f235e4.js";import{_ as _e}from"./ProductItem.vue_vue_type_style_index_0_lang-957453e5.js";import{_ as me}from"./_plugin-vue_export-helper-c27b6911.js";import"./use-id-b95949a2.js";import"./use-tab-status-6cb74775.js";import"./index-59155b31.js";import"./base64-982431c5.js";const B=b=>(te("data-v-a7fdf133"),b=b(),oe(),b),fe={class:"search-navbar-container"},he={class:"search-navbar",style:{"margin-right":"{{menuLeft}}px"}},ge={class:"search-navbar-search"},ye={class:"search-tab"},ke=["onClick"],be={key:0},Ce={class:"search-history-title"},we=B(()=>l("text",null,"历史搜索",-1)),Se={class:"search-history-content"},xe=["onClick"],Ie={key:2,class:"divider"},Ve=B(()=>l("div",{class:"divider-list"},null,-1)),Le=W({__name:"SearchList",setup(b){var z,E;pe();const L=Y(),{assets:i}=ee(),N=[{id:2,name:"京东",icon:i("jd_w.png"),icon_c:i("jd_c.png")},{id:1,name:"拼多多",icon:i("pdd_w.png"),icon_c:i("pdd_c.png")},{id:4,name:"抖音",icon:i("dy_w.png"),icon_c:i("dy_c.png")},{id:3,name:"淘宝",icon:i("tb_w.png"),icon_c:i("tb_c.png")},{id:5,name:"唯品会",icon:i("wph_w.png"),icon_c:i("wph_c.png")}],R=[{id:0,name:"综合"},{id:9,name:"价格"},{id:6,name:"销量"}],o={page:1,pageSize:20},s=u([]),v=u([]),_=u(!1),f=u(!1),C=u(!1),c=u(!1),h=u(2),x=u(0);h.value=parseInt(((z=L.query.type)==null?void 0:z.toString())??"2");const a=u(((E=L.query.keyword)==null?void 0:E.toString())??""),U=r=>{h.value=r.id,a.value&&(s.value=[],m())},$=()=>{a.value&&(P(),c.value=!1,m())},F=()=>{a.value="",s.value=[],c.value=!0,o.keyword=""},P=()=>{if(!a.value)return;const r=v.value.indexOf(a.value);r!==-1&&v.value.splice(r,1),v.value.splice(0,0,a.value),v.value.length>10&&v.value.splice(10,1),localStorage.setItem("history",JSON.stringify(v.value))},M=()=>{v.value=[],localStorage.removeItem("history")},O=r=>{a.value=r,c.value=!1,m()},j=()=>{o.sortType=x.value,a.value&&(c.value=!1,s.value=[],m())},m=()=>{_.value=!0,f.value=!1,C.value=!0,o.page=1,T()},q=()=>{s.value.length<o.page||(o.page++,T())},T=()=>{o.keyword=a.value,o.source=h.value,ve(o).then(r=>{var g,w;const n=((g=r.data)==null?void 0:g.list)??[];o.page===1?s.value=n:s.value=s.value.concat(n),_.value=!1,f.value=!1,C.value=s.value.length>=((w=r.data)==null?void 0:w.total)}).catch(()=>{_.value=!1,f.value=!1,C.value=!0,o.page>1&&o.page--})};return Z(()=>{a.value?(P(),c.value=!1,m()):c.value=!0}),(r,n)=>{const g=se,w=de,A=ue,D=re,J=ce,G=ie,K=le,X=ne;return t(),d(y,null,[l("div",fe,[l("div",he,[l("div",ge,[p(g,{name:"search",color:"#999"}),p(w,{modelValue:a.value,"onUpdate:modelValue":n[0]||(n[0]=e=>a.value=e),placeholder:"输入关键词找券",clearable:"",onClear:F},null,8,["modelValue"])]),l("div",{style:{color:"white","font-size":"14px"},onClick:$}," 搜索 ")]),l("div",ye,[(t(),d(y,null,S(N,e=>l("div",{class:ae(e.id===h.value?"search-tab-item search-tab-item-active":"search-tab-item"),key:e.id,onClick:Q=>U(e)},[p(A,{width:"16",height:"16",src:e.id===h.value?e.icon_c:e.icon},null,8,["src"]),l("text",null,H(e.name),1)],10,ke)),64))])]),c.value?(t(),d("div",be,[l("div",Ce,[we,p(g,{size:"22",color:"grey",name:"delete-o",onClick:M})]),l("div",Se,[(t(!0),d(y,null,S(v.value,e=>(t(),d("div",{key:e,class:"search-history-content-item",onClick:Q=>O(e)},H(e),9,xe))),128))])])):k("",!0),c.value?k("",!0):(t(),I(J,{key:1,ellipsis:!1,active:x.value,"onUpdate:active":n[1]||(n[1]=e=>x.value=e),color:"#fe8124","title-active-color":"#fe8124",onChange:j},{default:V(()=>[(t(),d(y,null,S(R,e=>p(D,{key:e.id,title:e.name,name:e.id},null,8,["title","name"])),64))]),_:1},8,["active"])),c.value?k("",!0):(t(),d("div",Ie)),c.value?k("",!0):(t(),I(X,{key:3,class:"page-container",modelValue:_.value,"onUpdate:modelValue":n[3]||(n[3]=e=>_.value=e),onRefresh:m},{default:V(()=>[p(G,{loading:f.value,"onUpdate:loading":n[2]||(n[2]=e=>f.value=e),finished:C.value,"finished-text":s.value.length>0?"没有更多了":"",onLoad:q},{default:V(()=>[(t(!0),d(y,null,S(s.value,e=>(t(),d("div",{style:{position:"relative","background-color":"white"},key:e.goods_id},[p(_e,{from:"collect",product:e},null,8,["product"]),Ve]))),128))]),_:1},8,["loading","finished","finished-text"]),!_.value&&s.value.length===0?(t(),I(K,{key:0,description:"还没有数据~"})):k("",!0)]),_:1},8,["modelValue"]))],64)}}});const Je=me(Le,[["__scopeId","data-v-a7fdf133"]]);export{Je as default};
